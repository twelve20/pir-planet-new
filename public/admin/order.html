<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ó–∞–∫–∞–∑ - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="/admin/css/order.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="page-header">
            <div class="header-content">
                <a href="/admin/orders" class="back-link">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
                <h1>–ó–∞–∫–∞–∑ <span id="orderNumber"></span></h1>
            </div>
        </header>

        <!-- Loading State -->
        <div id="loadingState" class="loading-state">
            <div class="spinner"></div>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–∞...</p>
        </div>

        <!-- Error State -->
        <div id="errorState" class="error-state" style="display: none;">
            <p>‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–∞</p>
            <button class="btn-secondary" onclick="location.href='/admin/orders'">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É</button>
        </div>

        <!-- Order Content -->
        <div id="orderContent" style="display: none;">
            <!-- Customer Info -->
            <section class="order-section">
                <h2>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ</h2>
                <div class="info-grid" id="customerInfo"></div>
            </section>

            <!-- Delivery Info -->
            <section class="order-section">
                <h2>–î–æ—Å—Ç–∞–≤–∫–∞</h2>
                <div class="info-grid" id="deliveryInfo"></div>
            </section>

            <!-- Items -->
            <section class="order-section">
                <h2>–¢–æ–≤–∞—Ä—ã</h2>
                <div id="itemsContainer"></div>

                <!-- Add Item Form -->
                <div class="add-item-form">
                    <h3>–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h3>
                    <div class="add-item-row">
                        <input type="text" id="newItemName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" class="add-item-input">
                        <input type="number" id="newItemQuantity" placeholder="–ö–æ–ª-–≤–æ" min="1" value="1" class="add-item-quantity">
                        <input type="number" id="newItemPrice" placeholder="–¶–µ–Ω–∞ (‚ÇΩ)" min="0" step="1" class="add-item-price">
                        <button type="button" class="btn-primary btn-add-item" onclick="orderPage.addNewItem()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>
                </div>

                <!-- Totals -->
                <div class="order-totals" id="orderTotals"></div>
            </section>

            <!-- Status Management -->
            <section class="order-section">
                <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–º</h2>

                <!-- Customer Link -->
                <div class="customer-link-section" style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; gap: 10px;">
                        <div>
                            <strong>–°—Å—ã–ª–∫–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞:</strong>
                            <p style="margin: 5px 0 0; font-size: 13px; color: #666;">–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç—É —Å—Å—ã–ª–∫—É –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–ª–∏–µ–Ω—Ç—É –¥–ª—è –æ–ø–ª–∞—Ç—ã –∑–∞–∫–∞–∑–∞</p>
                        </div>
                        <button type="button" class="btn-primary" onclick="orderPage.copyCustomerLink()" style="white-space: nowrap;">
                            üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
                        </button>
                    </div>
                </div>

                <form class="status-form" id="statusForm">
                    <div class="form-group">
                        <label for="orderStatus">–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞:</label>
                        <select id="orderStatus" name="status" required>
                            <option value="new">–ù–æ–≤—ã–π</option>
                            <option value="processing">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</option>
                            <option value="confirmed">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω</option>
                            <option value="paid">–û–ø–ª–∞—á–µ–Ω</option>
                            <option value="delivery_paid">–î–æ—Å—Ç–∞–≤–∫–∞ –æ–ø–ª–∞—á–µ–Ω–∞</option>
                            <option value="shipping">–í –¥–æ—Å—Ç–∞–≤–∫–µ</option>
                            <option value="completed">–í—ã–ø–æ–ª–Ω–µ–Ω</option>
                            <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="deliveryCost">–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ (‚ÇΩ):</label>
                        <input type="number" id="deliveryCost" name="deliveryCost" min="0" step="1" onchange="orderPage.updateTotalsDisplay()">
                    </div>

                    <div class="form-group">
                        <label for="managerComment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä–∞:</label>
                        <textarea id="managerComment" name="comment" rows="4"></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                        <button type="button" class="btn-secondary" onclick="location.href='/admin/orders'">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </form>
            </section>

            <!-- Delete Section -->
            <section class="order-section delete-section">
                <h2>–û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</h2>
                <p>–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ. –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.</p>
                <button type="button" class="btn-danger" onclick="orderPage.deleteOrder()">–£–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑</button>
            </section>

            <!-- Order Info -->
            <section class="order-section">
                <div class="order-meta" id="orderMeta"></div>
            </section>
        </div>
    </div>

    <script src="/admin/js/order.js"></script>
</body>
</html>
