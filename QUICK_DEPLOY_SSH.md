# –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ SSH –¥–ª—è pir-planet.ru

## –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ

### 1.1 –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ Git –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ GitHub

–û—Ç–∫—Ä–æ–π—Ç–µ PowerShell –∏–ª–∏ Git Bash:

```bash
cd "c:\Users\User\Documents\ProjectsByMe\the"

git init
git add .
git commit -m "PIR Planet website update"
```

–°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub:
- –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://github.com
- –ù–∞–∂–º–∏—Ç–µ "New repository"
- –ù–∞–∑–≤–∞–Ω–∏–µ: `pir-planet` (–∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ)
- –°–¥–µ–ª–∞–π—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º (–µ—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å)
- –ù–µ –¥–æ–±–∞–≤–ª—è–π—Ç–µ README, .gitignore (—É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å)
- –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–¥:
```bash
git remote add origin https://github.com/–≤–∞—à-username/pir-planet.git
git branch -M main
git push -u origin main
```

–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –æ—Ç GitHub (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Personal Access Token)

---

## –®–∞–≥ 2: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh –≤–∞—à_–ª–æ–≥–∏–Ω@pir-planet.ru
# –∏–ª–∏
ssh root@IP_–∞–¥—Ä–µ—Å
```

---

## –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js (–µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç)

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Node.js
node --version

# –ï—Å–ª–∏ –≤–µ—Ä—Å–∏—è 16+ - –≤—Å—ë –û–ö, –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É
# –ï—Å–ª–∏ –Ω–µ—Ç –∏–ª–∏ —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:

curl -fsSL https://deb.nodesource.com/setup_18.x | sudo bash -
sudo apt-get install -y nodejs

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É
node --version
npm --version
```

---

## –®–∞–≥ 4: –°–¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Å—Ç–∞—Ä–æ–≥–æ —Å–∞–π—Ç–∞

```bash
# –ù–∞–π–¥–∏—Ç–µ –ø–∞–ø–∫—É —Å–æ —Å—Ç–∞—Ä—ã–º —Å–∞–π—Ç–æ–º
ls /var/www/
# –∏–ª–∏
ls /home/–≤–∞—à_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å/

# –°–¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø (–∏–∑–º–µ–Ω–∏—Ç–µ –ø—É—Ç—å –Ω–∞ –≤–∞—à)
sudo cp -r /var/www/html /var/www/html_backup_$(date +%Y%m%d)

# –ò–ª–∏ –µ—Å–ª–∏ —Å–∞–π—Ç –≤ –¥—Ä—É–≥–æ–π –ø–∞–ø–∫–µ:
sudo cp -r /var/www/pir-planet /var/www/pir-planet_backup_$(date +%Y%m%d)
```

---

## –®–∞–≥ 5: –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π —Å–∞–π—Ç

```bash
cd /var/www/

# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
sudo git clone https://github.com/–≤–∞—à-username/pir-planet.git pir-planet-new

# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É
cd pir-planet-new

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
sudo npm install
```

---

## –®–∞–≥ 6: –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª

```bash
sudo nano .env
```

–í—Å—Ç–∞–≤—å—Ç–µ (–Ω–∞–∂–º–∏—Ç–µ –ø—Ä–∞–≤—É—é –∫–Ω–æ–ø–∫—É –º—ã—à–∏ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏):

```env
PORT=3000
TELEGRAM_BOT_TOKEN=7782157467:AAEiMm_UiBtyYD_5qOHkUQp5uJl60K_poLU
TELEGRAM_CHAT_ID=-4667528349
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ:
- –ù–∞–∂–º–∏—Ç–µ `Ctrl+X`
- –ù–∞–∂–º–∏—Ç–µ `Y`
- –ù–∞–∂–º–∏—Ç–µ `Enter`

---

## –®–∞–≥ 7: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PM2 –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∞–π—Ç

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PM2 –≥–ª–æ–±–∞–ª—å–Ω–æ
sudo npm install -g pm2

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∞–π—Ç
cd /var/www/pir-planet-new
pm2 start server.js --name pir-planet

# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é PM2
pm2 save

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
pm2 startup
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É, –∫–æ—Ç–æ—Ä—É—é –≤—ã–≤–µ–¥–µ—Ç PM2 (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ)

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
pm2 status
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id  ‚îÇ name         ‚îÇ mode        ‚îÇ ‚Ü∫       ‚îÇ status  ‚îÇ cpu      ‚îÇ memory ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 0   ‚îÇ pir-planet   ‚îÇ fork        ‚îÇ 0       ‚îÇ online  ‚îÇ 0%       ‚îÇ 50.0mb ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –®–∞–≥ 8: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Nginx

### 8.1 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Nginx

```bash
nginx -v

# –ï—Å–ª–∏ –Ω–µ—Ç - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
sudo apt update
sudo apt install nginx -y
```

### 8.2 –°–æ–∑–¥–∞–π—Ç–µ/–∏–∑–º–µ–Ω–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

```bash
sudo nano /etc/nginx/sites-available/pir-planet.ru
```

–í—Å—Ç–∞–≤—å—Ç–µ (–∑–∞–º–µ–Ω–∏—Ç–µ –≤—Å—ë —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ):

```nginx
server {
    listen 80;
    listen [::]:80;
    server_name pir-planet.ru www.pir-planet.ru;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: `Ctrl+X`, `Y`, `Enter`

### 8.3 –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Å–∏–º–ª–∏–Ω–∫ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç)
sudo ln -sf /etc/nginx/sites-available/pir-planet.ru /etc/nginx/sites-enabled/

# –£–¥–∞–ª–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–µ—Å–ª–∏ –º–µ—à–∞–µ—Ç)
sudo rm -f /etc/nginx/sites-enabled/default

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo nginx -t

# –ï—Å–ª–∏ –≤—Å—ë OK - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Nginx
sudo systemctl restart nginx
```

---

## –®–∞–≥ 9: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSL (HTTPS)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Certbot
sudo apt update
sudo apt install certbot python3-certbot-nginx -y

# –ü–æ–ª—É—á–∏—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
sudo certbot --nginx -d pir-planet.ru -d www.pir-planet.ru

# –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º:
# 1. –í–≤–µ–¥–∏—Ç–µ email
# 2. –°–æ–≥–ª–∞—Å–∏—Ç–µ—Å—å —Å —É—Å–ª–æ–≤–∏—è–º–∏ (Y)
# 3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è HTTP->HTTPS (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–∞—Ä–∏–∞–Ω—Ç 2)
```

---

## –®–∞–≥ 10: –ü—Ä–æ–≤–µ—Ä–∫–∞

### 10.1 –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ

https://pir-planet.ru

### 10.2 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
- ‚úÖ –ì–ª–∞–≤–Ω–∞—è
- ‚úÖ –ö–∞—Ç–∞–ª–æ–≥
- ‚úÖ –ì–∞–ª–µ—Ä–µ—è
- ‚úÖ –ö–æ–Ω—Ç–∞–∫—Ç—ã

### 10.3 –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –Ω–∞ –ª—é–±–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram

---

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∞–π—Ç–æ–º

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
pm2 logs pir-planet
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫:
```bash
pm2 restart pir-planet
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
pm2 stop pir-planet
```

### –°—Ç–∞—Ç—É—Å:
```bash
pm2 status
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
```bash
pm2 monit
```

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∞–π—Ç–∞ –≤ –±—É–¥—É—â–µ–º

```bash
cd /var/www/pir-planet-new
sudo git pull
sudo npm install
pm2 restart pir-planet
```

---

## –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ - –æ—Ç–∫–∞—Ç

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–æ–≤—ã–π —Å–∞–π—Ç
pm2 stop pir-planet
pm2 delete pir-planet

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ä—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx
# (–µ—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏ –±—ç–∫–∞–ø)

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Nginx
sudo systemctl restart nginx
```

---

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 502 Bad Gateway
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–ø—É—â–µ–Ω –ª–∏ —Å–∞–π—Ç
pm2 status

# –ï—Å–ª–∏ –Ω–µ—Ç - –∑–∞–ø—É—Å—Ç–∏—Ç–µ
cd /var/www/pir-planet-new
pm2 start server.js --name pir-planet
```

### Port already in use
```bash
# –ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å
sudo lsof -i :3000

# –£–±–µ–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å (–∑–∞–º–µ–Ω–∏—Ç–µ PID –Ω–∞ –Ω—É–∂–Ω—ã–π)
sudo kill -9 PID
```

### –§–æ—Ä–º–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
pm2 logs pir-planet

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª
cat /var/www/pir-planet-new/.env
```

---

## –ì–æ—Ç–æ–≤–æ! üöÄ

–í–∞—à –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ https://pir-planet.ru
